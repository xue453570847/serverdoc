<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>diffç®—æ³• | Hello</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="Hello, my friend!">
    <link rel="preload" href="/assets/css/0.styles.ae176247.css" as="style"><link rel="preload" href="/assets/js/app.0546edb6.js" as="script"><link rel="preload" href="/assets/js/2.705226bb.js" as="script"><link rel="preload" href="/assets/js/24.887cb6da.js" as="script"><link rel="prefetch" href="/assets/js/10.9e439d68.js"><link rel="prefetch" href="/assets/js/11.1b226cf0.js"><link rel="prefetch" href="/assets/js/12.38c3b1a6.js"><link rel="prefetch" href="/assets/js/13.a998d9ed.js"><link rel="prefetch" href="/assets/js/14.fe8355a2.js"><link rel="prefetch" href="/assets/js/15.43db0993.js"><link rel="prefetch" href="/assets/js/16.8b1529eb.js"><link rel="prefetch" href="/assets/js/17.a7e9dce6.js"><link rel="prefetch" href="/assets/js/18.d1a6cc65.js"><link rel="prefetch" href="/assets/js/19.5deabdc6.js"><link rel="prefetch" href="/assets/js/20.f06f02a7.js"><link rel="prefetch" href="/assets/js/21.dc820b9d.js"><link rel="prefetch" href="/assets/js/22.b989ae5f.js"><link rel="prefetch" href="/assets/js/23.eada9f7e.js"><link rel="prefetch" href="/assets/js/25.490aebc8.js"><link rel="prefetch" href="/assets/js/26.a2659ee0.js"><link rel="prefetch" href="/assets/js/27.d743b912.js"><link rel="prefetch" href="/assets/js/28.062ff039.js"><link rel="prefetch" href="/assets/js/29.42480b13.js"><link rel="prefetch" href="/assets/js/3.e7736b8e.js"><link rel="prefetch" href="/assets/js/4.7498c97f.js"><link rel="prefetch" href="/assets/js/5.bfe097fd.js"><link rel="prefetch" href="/assets/js/6.14afed8d.js"><link rel="prefetch" href="/assets/js/7.57eed9c6.js"><link rel="prefetch" href="/assets/js/8.8d5bee32.js"><link rel="prefetch" href="/assets/js/9.f23dc594.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ae176247.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Hello</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/swiper/" class="nav-link">
  Swiper
</a></div><div class="nav-item"><a href="/database/" class="nav-link">
  Database
</a></div><div class="nav-item"><a href="/vueskill/" class="nav-link router-link-active">
  Vue
</a></div><div class="nav-item"><a href="https://www.xuezsl.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/swiper/" class="nav-link">
  Swiper
</a></div><div class="nav-item"><a href="/database/" class="nav-link">
  Database
</a></div><div class="nav-item"><a href="/vueskill/" class="nav-link router-link-active">
  Vue
</a></div><div class="nav-item"><a href="https://www.xuezsl.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>vueå¼€å‘æŠ€å·§</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vueskill/" aria-current="page" class="sidebar-link">require.context()</a></li><li><a href="/vueskill/message.html" class="sidebar-link">ç»„ä»¶é€šè®¯</a></li><li><a href="/vueskill/render.html" class="sidebar-link">renderå‡½æ•°</a></li><li><a href="/vueskill/actioncomponent.html" class="sidebar-link">åŠ¨æ€ç»„ä»¶</a></li><li><a href="/vueskill/mixins.html" class="sidebar-link">mixins</a></li><li><a href="/vueskill/filter.html" class="sidebar-link">Vue.filter</a></li><li><a href="/vueskill/router.html" class="sidebar-link">å…¨å±€è·¯ç”±</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>æ·±å…¥</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vueskill/diff.html" aria-current="page" class="active sidebar-link">diffç®—æ³•</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vueskill/diff.html#vueæ›´æ–°èŠ‚ç‚¹" class="sidebar-link">vueæ›´æ–°èŠ‚ç‚¹</a></li><li class="sidebar-sub-header"><a href="/vueskill/diff.html#virtual-domå’ŒçœŸå®domçš„åŒºåˆ«" class="sidebar-link">Virtual DOMå’ŒçœŸå®DOMçš„åŒºåˆ«</a></li><li class="sidebar-sub-header"><a href="/vueskill/diff.html#diffæ¯”è¾ƒ" class="sidebar-link">diffæ¯”è¾ƒ</a></li><li class="sidebar-sub-header"><a href="/vueskill/diff.html#diffç®—æ³•æµç¨‹å›¾" class="sidebar-link">diffç®—æ³•æµç¨‹å›¾</a></li><li class="sidebar-sub-header"><a href="/vueskill/diff.html#patch" class="sidebar-link">patch</a></li><li class="sidebar-sub-header"><a href="/vueskill/diff.html#patchvnode" class="sidebar-link">patchVnode</a></li><li class="sidebar-sub-header"><a href="/vueskill/diff.html#updatechildren" class="sidebar-link">updateChildren</a></li><li class="sidebar-sub-header"><a href="/vueskill/diff.html#å®ä¾‹æ¨¡æ‹Ÿ" class="sidebar-link">å®ä¾‹æ¨¡æ‹Ÿ</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="diffç®—æ³•"><a href="#diffç®—æ³•" class="header-anchor">#</a> diffç®—æ³•</h1> <h2 id="vueæ›´æ–°èŠ‚ç‚¹"><a href="#vueæ›´æ–°èŠ‚ç‚¹" class="header-anchor">#</a> vueæ›´æ–°èŠ‚ç‚¹</h2> <p>Q: vueå‘ç”Ÿæ•°æ®å‘ç”Ÿå˜åŒ–ï¼Œvueå¦‚ä½•æ›´æ–°èŠ‚ç‚¹?</p> <p>å½“æˆ‘ä»¬æ›´æ–°æ•°æ®æ—¶ï¼Œå¦‚æœç›´æ¥æ¸²æŸ“åˆ°çœŸå®DOMä¸Šä¼šå¼•èµ·æ•´ä¸ªDOMæ ‘çš„é‡ç»˜å’Œå›æµã€å›æµå¿…ä¼šé‡ç»˜ï¼Œé‡ç»˜æœªå¿…å›æµã€‘,é€ æˆå¼€é”€å¾ˆå¤§ï¼Œè¿™æ—¶å€™ï¼Œå°±ç”¨åˆ°äº†diffç®—æ³•è§£å†³è¿™ä¸€é—®é¢˜</p> <p>æˆ‘ä»¬å…ˆæ ¹æ®çœŸå®DOMç”Ÿæˆä¸€æ£µvirtual DOMã€è™šæ‹Ÿdomæ ‘ğŸŒ²ã€‘ï¼Œå½“virtual DOMæŸä¸ªèŠ‚ç‚¹çš„æ•°æ®æ”¹å˜åä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„Vnodeï¼Œç„¶åVnodeå’ŒoldVnodeä½œå¯¹æ¯”ï¼Œå‘ç°æœ‰ä¸ä¸€æ ·çš„åœ°æ–¹å°±ç›´æ¥ä¿®æ”¹åœ¨çœŸå®çš„DOMä¸Šï¼Œç„¶åä½¿oldVnodeçš„å€¼ä¸ºVnodeã€‚</p> <h2 id="virtual-domå’ŒçœŸå®domçš„åŒºåˆ«"><a href="#virtual-domå’ŒçœŸå®domçš„åŒºåˆ«" class="header-anchor">#</a> Virtual DOMå’ŒçœŸå®DOMçš„åŒºåˆ«</h2> <p>virtual DOMæ˜¯å°†çœŸå®çš„DOMçš„æ•°æ®æŠ½å–å‡ºæ¥ï¼Œä»¥å¯¹è±¡çš„å½¢å¼æ¨¡æ‹Ÿæ ‘å½¢ç»“æ„ã€‚æ¯”å¦‚domæ˜¯è¿™æ ·çš„ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token number">123</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre></div><p>è½¬æ¢æˆè™šæ‹Ÿdom</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> Vnode <span class="token operator">=</span> <span class="token punctuation">{</span>
    tag<span class="token operator">:</span> <span class="token string">'div'</span><span class="token punctuation">,</span>
    children<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span> tag<span class="token operator">:</span> <span class="token string">'p'</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">'123'</span> <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„vnode</p> <div class="language-js extra-class"><pre class="language-js"><code> 
<span class="token punctuation">{</span>
  el<span class="token operator">:</span>  div  <span class="token comment">//å¯¹çœŸå®çš„èŠ‚ç‚¹çš„å¼•ç”¨ï¼Œæœ¬ä¾‹ä¸­å°±æ˜¯document.querySelector('#id.classA')</span>
  tagName<span class="token operator">:</span> <span class="token string">'DIV'</span><span class="token punctuation">,</span>   <span class="token comment">//èŠ‚ç‚¹çš„æ ‡ç­¾</span>
  sel<span class="token operator">:</span> <span class="token string">'div#v.classA'</span>  <span class="token comment">//èŠ‚ç‚¹çš„é€‰æ‹©å™¨</span>
  data<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>       <span class="token comment">// ä¸€ä¸ªå­˜å‚¨èŠ‚ç‚¹å±æ€§çš„å¯¹è±¡ï¼Œå¯¹åº”èŠ‚ç‚¹çš„el[prop]å±æ€§ï¼Œä¾‹å¦‚onclick , style</span>
  children<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//å­˜å‚¨å­èŠ‚ç‚¹çš„æ•°ç»„ï¼Œæ¯ä¸ªå­èŠ‚ç‚¹ä¹Ÿæ˜¯vnodeç»“æ„</span>
  text<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>    <span class="token comment">//å¦‚æœæ˜¯æ–‡æœ¬èŠ‚ç‚¹ï¼Œå¯¹åº”æ–‡æœ¬èŠ‚ç‚¹çš„textContentï¼Œå¦åˆ™ä¸ºnull</span>
<span class="token punctuation">}</span>

</code></pre></div><div class="custom-block warning"><p class="custom-block-title">è­¦å‘Š</p> <p>VNodeå’ŒoldVNodeéƒ½æ˜¯å¯¹è±¡</p></div> <h2 id="diffæ¯”è¾ƒ"><a href="#diffæ¯”è¾ƒ" class="header-anchor">#</a> diffæ¯”è¾ƒ</h2> <div class="custom-block warning"><p class="custom-block-title">æç¤º</p> <p>åœ¨é‡‡å–diffç®—æ³•æ¯”è¾ƒæ–°æ—§èŠ‚ç‚¹çš„æ—¶å€™ï¼Œæ¯”è¾ƒåªä¼šåœ¨åŒå±‚çº§è¿›è¡Œ, ä¸ä¼šè·¨å±‚çº§æ¯”è¾ƒã€‚</p> <p>ä¸¤ä¸ªvnodeçš„keyå’Œselç›¸åŒæ‰å»æ¯”è¾ƒå®ƒä»¬ï¼Œæ¯”å¦‚på’Œspanï¼Œdiv.classAå’Œdiv.classBéƒ½è¢«è®¤ä¸ºæ˜¯ä¸åŒç»“æ„è€Œä¸å»æ¯”è¾ƒå®ƒä»¬ã€‚</p></div> <h2 id="diffç®—æ³•æµç¨‹å›¾"><a href="#diffç®—æ³•æµç¨‹å›¾" class="header-anchor">#</a> diffç®—æ³•æµç¨‹å›¾</h2> <p>å½“æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶ï¼Œsetæ–¹æ³•ä¼šè®©è°ƒç”¨Dep.notifyé€šçŸ¥æ‰€æœ‰è®¢é˜…è€…Watcherï¼Œè®¢é˜…è€…å°±ä¼šè°ƒç”¨patchç»™çœŸå®çš„DOMæ‰“è¡¥ä¸ï¼Œæ›´æ–°ç›¸åº”çš„è§†å›¾ã€‚</p> <p><img src="https://images2018.cnblogs.com/blog/998023/201805/998023-20180519212357826-1474719173.png" alt="image"></p> <h2 id="patch"><a href="#patch" class="header-anchor">#</a> patch</h2> <p>patchå…·ä½“å®ç°</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// æ¥å—äºŒä¸ªå‚æ•°ï¼ŒoldVnodeå’ŒVnodeåˆ†åˆ«ä»£è¡¨æ–°çš„èŠ‚ç‚¹å’Œä¹‹å‰çš„æ—§èŠ‚ç‚¹</span>
<span class="token keyword">function</span> <span class="token function">patch</span> <span class="token punctuation">(</span><span class="token parameter">oldVnode<span class="token punctuation">,</span> vnode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// some code</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sameVnode</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">,</span> vnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">patchVnode</span><span class="token punctuation">(</span>oldVnode<span class="token punctuation">,</span> vnode<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> oEl <span class="token operator">=</span> oldVnode<span class="token punctuation">.</span>el <span class="token comment">// å½“å‰oldVnodeå¯¹åº”çš„çœŸå®å…ƒç´ èŠ‚ç‚¹</span>
        <span class="token keyword">let</span> parentEle <span class="token operator">=</span> api<span class="token punctuation">.</span><span class="token function">parentNode</span><span class="token punctuation">(</span>oEl<span class="token punctuation">)</span>  <span class="token comment">// çˆ¶å…ƒç´ </span>
        <span class="token function">createEle</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span>  <span class="token comment">// æ ¹æ®Vnodeç”Ÿæˆæ–°å…ƒç´ </span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>parentEle <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            api<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>parentEle<span class="token punctuation">,</span> vnode<span class="token punctuation">.</span>el<span class="token punctuation">,</span> api<span class="token punctuation">.</span><span class="token function">nextSibling</span><span class="token punctuation">(</span>oEl<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// å°†æ–°å…ƒç´ æ·»åŠ è¿›çˆ¶å…ƒç´ </span>
            api<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>parentEle<span class="token punctuation">,</span> oldVnode<span class="token punctuation">.</span>el<span class="token punctuation">)</span>  <span class="token comment">// ç§»é™¤ä»¥å‰çš„æ—§å…ƒç´ èŠ‚ç‚¹</span>
            oldVnode <span class="token operator">=</span> <span class="token keyword">null</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// some code </span>
    <span class="token keyword">return</span> vnode
<span class="token punctuation">}</span>
</code></pre></div><p>sameVnodeåˆ¤æ–­æ–°æ—§èŠ‚ç‚¹æ˜¯å¦ç›¸ä¼¼ï¼Œç›¸ä¼¼æ‰§è¡ŒpatchVnode,å®Œå…¨ä¸åŒç”¨Vnodeæ›¿æ¢oldVnode</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sameVnode</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    a<span class="token punctuation">.</span>key <span class="token operator">===</span> b<span class="token punctuation">.</span>key <span class="token operator">&amp;&amp;</span>  <span class="token comment">// keyå€¼</span>
    a<span class="token punctuation">.</span>tag <span class="token operator">===</span> b<span class="token punctuation">.</span>tag <span class="token operator">&amp;&amp;</span>  <span class="token comment">// æ ‡ç­¾å</span>
    a<span class="token punctuation">.</span>isComment <span class="token operator">===</span> b<span class="token punctuation">.</span>isComment <span class="token operator">&amp;&amp;</span>  <span class="token comment">// æ˜¯å¦ä¸ºæ³¨é‡ŠèŠ‚ç‚¹</span>
    <span class="token comment">// æ˜¯å¦éƒ½å®šä¹‰äº†dataï¼ŒdataåŒ…å«ä¸€äº›å…·ä½“ä¿¡æ¯ï¼Œä¾‹å¦‚onclick , style</span>
    <span class="token function">isDef</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">isDef</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>  
    <span class="token function">sameInputType</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token comment">// å½“æ ‡ç­¾æ˜¯&lt;input&gt;çš„æ—¶å€™ï¼Œtypeå¿…é¡»ç›¸åŒ</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">è­¦å‘Š</p> <p>diffé€å±‚æ¯”è¾ƒçš„ï¼Œå¦‚æœç¬¬ä¸€å±‚ä¸ä¸€æ ·é‚£ä¹ˆå°±ä¸ä¼šç»§ç»­æ·±å…¥æ¯”è¾ƒç¬¬äºŒå±‚äº†ã€‚</p></div> <h2 id="patchvnode"><a href="#patchvnode" class="header-anchor">#</a> patchVnode</h2> <p>å½“äºŒä¸ªèŠ‚ç‚¹ç›¸ä¼¼æˆ‘ä»¬å¯¹å…¶è¿›è¡Œæ¯”è¾ƒ,è°ƒç”¨patchVnode</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">patchVnode</span> <span class="token punctuation">(</span><span class="token parameter">oldVnode<span class="token punctuation">,</span> vnode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> el <span class="token operator">=</span> vnode<span class="token punctuation">.</span>el <span class="token operator">=</span> oldVnode<span class="token punctuation">.</span>el <span class="token comment">//å¯¹åº”çš„çœŸå®dom</span>
    <span class="token keyword">let</span> i<span class="token punctuation">,</span> oldCh <span class="token operator">=</span> oldVnode<span class="token punctuation">.</span>children<span class="token punctuation">,</span> ch <span class="token operator">=</span> vnode<span class="token punctuation">.</span>children
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldVnode <span class="token operator">===</span> vnode<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token comment">// å¼•ç”¨ä¸€è‡´ï¼Œå¯ä»¥è®¤ä¸ºæ²¡æœ‰å˜åŒ–ã€‚ç›´æ¥return</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldVnode<span class="token punctuation">.</span>text <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> vnode<span class="token punctuation">.</span>text <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> oldVnode<span class="token punctuation">.</span>text <span class="token operator">!==</span> vnode<span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        api<span class="token punctuation">.</span><span class="token function">setTextContent</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> vnode<span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token comment">// æ–‡æœ¬èŠ‚ç‚¹çš„æ¯”è¾ƒï¼Œéœ€è¦ä¿®æ”¹ï¼Œåˆ™ä¼šè°ƒç”¨Node.textContent = vnode.textã€‚</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">updateEle</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> vnode<span class="token punctuation">,</span> oldVnode<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCh <span class="token operator">&amp;&amp;</span> ch <span class="token operator">&amp;&amp;</span> oldCh <span class="token operator">!==</span> ch<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">updateChildren</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> oldCh<span class="token punctuation">,</span> ch<span class="token punctuation">)</span> <span class="token comment">// ä¸¤ä¸ªèŠ‚ç‚¹éƒ½æœ‰å­èŠ‚ç‚¹ï¼Œè€Œä¸”å®ƒä»¬ä¸ä¸€æ ·ï¼Œè¿™æ ·æˆ‘ä»¬ä¼šè°ƒç”¨updateChildrenå‡½æ•°æ¯”è¾ƒå­èŠ‚ç‚¹ï¼Œè¿™æ˜¯diffçš„æ ¸å¿ƒ</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">{</span> 
            <span class="token function">createEle</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span> <span class="token comment">//åªæœ‰æ–°çš„èŠ‚ç‚¹æœ‰å­èŠ‚ç‚¹ï¼Œè°ƒç”¨createEle(vnode)ï¼Œvnode.elå·²ç»å¼•ç”¨äº†è€çš„domèŠ‚ç‚¹ï¼ŒcreateEleå‡½æ•°ä¼šåœ¨è€domèŠ‚ç‚¹ä¸Šæ·»åŠ å­èŠ‚ç‚¹ã€‚</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCh<span class="token punctuation">)</span><span class="token punctuation">{</span>
            api<span class="token punctuation">.</span><span class="token function">removeChildren</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span> <span class="token comment">// æ–°èŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹ï¼Œè€èŠ‚ç‚¹æœ‰å­èŠ‚ç‚¹ï¼Œç›´æ¥åˆ é™¤è€èŠ‚ç‚¹ã€‚</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="updatechildren"><a href="#updatechildren" class="header-anchor">#</a> updateChildren</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">updateChildren</span> <span class="token punctuation">(</span><span class="token parameter">parentElm<span class="token punctuation">,</span> oldCh<span class="token punctuation">,</span> newCh</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> oldStartIdx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> newStartIdx <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">let</span> oldEndIdx <span class="token operator">=</span> oldCh<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token keyword">let</span> oldStartVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> oldEndVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span>oldEndIdx<span class="token punctuation">]</span>
    <span class="token keyword">let</span> newEndIdx <span class="token operator">=</span> newCh<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token keyword">let</span> newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> newEndVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span>newEndIdx<span class="token punctuation">]</span>
    <span class="token keyword">let</span> oldKeyToIdx
    <span class="token keyword">let</span> idxInOld
    <span class="token keyword">let</span> elmToMove
    <span class="token keyword">let</span> before
    <span class="token keyword">while</span> <span class="token punctuation">(</span>oldStartIdx <span class="token operator">&lt;=</span> oldEndIdx <span class="token operator">&amp;&amp;</span> newStartIdx <span class="token operator">&lt;=</span> newEndIdx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>oldStartVnode <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment">//å¯¹äºvnode.keyçš„æ¯”è¾ƒï¼Œä¼šæŠŠoldVnode = null</span>
                oldStartVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">++</span>oldStartIdx<span class="token punctuation">]</span> 
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>oldEndVnode <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                oldEndVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">--</span>oldEndIdx<span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>newStartVnode <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">++</span>newStartIdx<span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>newEndVnode <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                newEndVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">--</span>newEndIdx<span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sameVnode</span><span class="token punctuation">(</span>oldStartVnode<span class="token punctuation">,</span> newStartVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">patchVnode</span><span class="token punctuation">(</span>oldStartVnode<span class="token punctuation">,</span> newStartVnode<span class="token punctuation">)</span>
                oldStartVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">++</span>oldStartIdx<span class="token punctuation">]</span>
                newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">++</span>newStartIdx<span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sameVnode</span><span class="token punctuation">(</span>oldEndVnode<span class="token punctuation">,</span> newEndVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">patchVnode</span><span class="token punctuation">(</span>oldEndVnode<span class="token punctuation">,</span> newEndVnode<span class="token punctuation">)</span>
                oldEndVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">--</span>oldEndIdx<span class="token punctuation">]</span>
                newEndVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">--</span>newEndIdx<span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sameVnode</span><span class="token punctuation">(</span>oldStartVnode<span class="token punctuation">,</span> newEndVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">patchVnode</span><span class="token punctuation">(</span>oldStartVnode<span class="token punctuation">,</span> newEndVnode<span class="token punctuation">)</span>
                api<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> oldStartVnode<span class="token punctuation">.</span>el<span class="token punctuation">,</span> api<span class="token punctuation">.</span><span class="token function">nextSibling</span><span class="token punctuation">(</span>oldEndVnode<span class="token punctuation">.</span>el<span class="token punctuation">)</span><span class="token punctuation">)</span>
                oldStartVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">++</span>oldStartIdx<span class="token punctuation">]</span>
                newEndVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">--</span>newEndIdx<span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sameVnode</span><span class="token punctuation">(</span>oldEndVnode<span class="token punctuation">,</span> newStartVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">patchVnode</span><span class="token punctuation">(</span>oldEndVnode<span class="token punctuation">,</span> newStartVnode<span class="token punctuation">)</span>
                api<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> oldEndVnode<span class="token punctuation">.</span>el<span class="token punctuation">,</span> oldStartVnode<span class="token punctuation">.</span>el<span class="token punctuation">)</span>
                oldEndVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">--</span>oldEndIdx<span class="token punctuation">]</span>
                newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">++</span>newStartIdx<span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
               <span class="token comment">// ä½¿ç”¨keyæ—¶çš„æ¯”è¾ƒ</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>oldKeyToIdx <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    oldKeyToIdx <span class="token operator">=</span> <span class="token function">createKeyToOldIdx</span><span class="token punctuation">(</span>oldCh<span class="token punctuation">,</span> oldStartIdx<span class="token punctuation">,</span> oldEndIdx<span class="token punctuation">)</span> <span class="token comment">// æœ‰keyç”Ÿæˆindexè¡¨</span>
                <span class="token punctuation">}</span>
                idxInOld <span class="token operator">=</span> oldKeyToIdx<span class="token punctuation">[</span>newStartVnode<span class="token punctuation">.</span>key<span class="token punctuation">]</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>idxInOld<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    api<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> <span class="token function">createEle</span><span class="token punctuation">(</span>newStartVnode<span class="token punctuation">)</span><span class="token punctuation">.</span>el<span class="token punctuation">,</span> oldStartVnode<span class="token punctuation">.</span>el<span class="token punctuation">)</span>
                    newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">++</span>newStartIdx<span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    elmToMove <span class="token operator">=</span> oldCh<span class="token punctuation">[</span>idxInOld<span class="token punctuation">]</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>elmToMove<span class="token punctuation">.</span>sel <span class="token operator">!==</span> newStartVnode<span class="token punctuation">.</span>sel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        api<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> <span class="token function">createEle</span><span class="token punctuation">(</span>newStartVnode<span class="token punctuation">)</span><span class="token punctuation">.</span>el<span class="token punctuation">,</span> oldStartVnode<span class="token punctuation">.</span>el<span class="token punctuation">)</span>
                    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
                        <span class="token function">patchVnode</span><span class="token punctuation">(</span>elmToMove<span class="token punctuation">,</span> newStartVnode<span class="token punctuation">)</span>
                        oldCh<span class="token punctuation">[</span>idxInOld<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span>
                        api<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> elmToMove<span class="token punctuation">.</span>el<span class="token punctuation">,</span> oldStartVnode<span class="token punctuation">.</span>el<span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                    newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">++</span>newStartIdx<span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldStartIdx <span class="token operator">&gt;</span> oldEndIdx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            before <span class="token operator">=</span> newCh<span class="token punctuation">[</span>newEndIdx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> newCh<span class="token punctuation">[</span>newEndIdx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>el
            <span class="token function">addVnodes</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> before<span class="token punctuation">,</span> newCh<span class="token punctuation">,</span> newStartIdx<span class="token punctuation">,</span> newEndIdx<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>newStartIdx <span class="token operator">&gt;</span> newEndIdx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">removeVnodes</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> oldCh<span class="token punctuation">,</span> oldStartIdx<span class="token punctuation">,</span> oldEndIdx<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><p>åˆ†åˆ«ä¸ºæ–°æ—§vnodeçš„å¤´å°¾è®¾ç½®ä¸€ä¸ªæ ‡è®°ï¼Œåˆ†åˆ«ä¸ºnewStartIdx, newEndIdx, oldStartIdx, oldEndIdxï¼Œå¾ªç¯éå†ç›´åˆ°éå†å®ŒnewVnodesæˆ–oldVnodesã€‚</p></li> <li><p>å¯¹æ¯”newStartVnodeä¸oldStartVnodeï¼Œè‹¥æ˜¯åŒä¸€ä¸ªvnodeï¼Œå°±è°ƒç”¨patchVnodeï¼Œå¹¶æŠŠnewStartIdxä¸oldStartIdxåˆ†åˆ«+1ã€‚</p></li> <li><p>åŒç†å¯¹æ¯”newEndVnodeä¸oldEndVnodeã€‚</p></li> <li><p>å¯¹æ¯”oldStartVnodeä¸newEndVnodeï¼Œè‹¥æ˜¯åŒä¸€ä¸ªvnodeï¼Œè°ƒç”¨patchVnodeï¼Œåˆ†åˆ«å¯¹Idxåšç§»ä½å¤„ç†ï¼Œå¹¶æŠŠoldStartVnodeå¯¹åº”çš„çœŸå®domç§»åˆ°å³è¾¹ã€‚</p></li> <li><p>åŒç†å¯¹æ¯”oldEndVnode, newStartVnodeã€‚</p></li> <li><p>å¾ªç¯ç»“æŸï¼Œè‹¥oldStartIdx &gt; oldEndIdxï¼Œè¯´æ˜å‰©ä½™çš„newVnodeæ˜¯å¤šå‡ºæ¥çš„ï¼Œè°ƒç”¨addVnodesæ·»åŠ åˆ°æ–‡æ¡£ä¸­ï¼›è‹¥newStartIdx &gt; newEndIdx, åˆ™è¯´æ˜å‰©ä½™çš„oldVnodeæ˜¯å¤šä½™çš„ï¼Œè°ƒç”¨removeVnodesæ–¹æ³•åˆ é™¤ã€‚</p></li> <li><p>å¯¹äºæœ‰keyçš„èŠ‚ç‚¹çš„å¤„ç†ï¼Œä¸»è¦çš„é€»è¾‘ä¸ºï¼š
1.ç”Ÿæˆä¸€ä¸ªkeyä¸oldVnodeIdxå¯¹åº”çš„å“ˆå¸Œè¡¨ã€‚
2.æŸ¥æ‰¾å½“å‰newStartVnodeçš„keyæ˜¯å¦åœ¨è¿™ä¸ªå“ˆå¸Œè¡¨ä¸­ï¼Œæ˜¯çš„è¯å°±è®¤ä¸ºæ˜¯åŒä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¯¹è¿™ä¸¤ä¸ªèŠ‚ç‚¹åšpatchVnodeæ“ä½œã€‚</p></li></ul> <div class="custom-block warning"><p class="custom-block-title">è®¾ç½®keyå’Œä¸è®¾ç½®keyçš„åŒºåˆ«ï¼š</p> <p>ä¸è®¾keyï¼ŒnewChå’ŒoldChåªä¼šè¿›è¡Œå¤´å°¾ä¸¤ç«¯çš„ç›¸äº’æ¯”è¾ƒï¼Œè®¾keyåï¼Œé™¤äº†å¤´å°¾ä¸¤ç«¯çš„æ¯”è¾ƒå¤–ï¼Œè¿˜ä¼šä»ç”¨keyç”Ÿæˆçš„å¯¹è±¡oldKeyToIdxä¸­æŸ¥æ‰¾åŒ¹é…çš„èŠ‚ç‚¹ï¼Œæ‰€ä»¥ä¸ºèŠ‚ç‚¹è®¾ç½®keyå¯ä»¥æ›´é«˜æ•ˆçš„åˆ©ç”¨domã€‚</p> <p>a,b,c,d,eå‡è®¾æ˜¯4ä¸ªä¸åŒçš„å…ƒç´ ï¼Œæˆ‘ä»¬æ²¡æœ‰è®¾ç½®keyæ—¶ï¼Œbæ²¡æœ‰å¤ç”¨ï¼Œè€Œæ˜¯ç›´æ¥åˆ›å»ºæ–°çš„ï¼Œåˆ é™¤æ—§çš„</p> <p>å½“æˆ‘ä»¬ç»™4ä¸ªå…ƒç´ åŠ ä¸Šå”¯ä¸€keyæ—¶ï¼Œbå¾—åˆ°äº†çš„å¤ç”¨ã€‚</p></div> <div class="custom-block warning"><p class="custom-block-title">åœ¨å¾ªç¯ä¸­keyå€¼æœ€å¥½ä¸è¦ç”¨indexçš„åŸå› ï¼Ÿ</p> <p>å¦‚æœkeyå€¼ä½¿ç”¨indexçš„è¯ï¼Œå°±å¯èƒ½æ— æ³•ä½¿åŸå§‹çš„è™šæ‹ŸDOMä¸­çš„keyå€¼å’Œæ–°çš„è™šæ‹ŸDOMä¸­çš„keyå€¼ä¸€è‡´ï¼Œä»è€Œä¸èƒ½å……åˆ†å‘æŒ¥diffç®—æ³•çš„ä¼˜åŠ¿ã€‚</p> <p>æ¯”å¦‚ä¸€ä¸ªæ•°ç»„é‡Œæœ‰æ•°æ®a  b   cï¼Œç”¨indexè¡¨ç¤ºçš„keyåˆ†åˆ«ä¸º0  1   2</p> <p>å½“åˆ é™¤aæ—¶ï¼Œb  cçš„keyåˆ†åˆ«ä¸º0    2ï¼Œä»è€Œå¯¼è‡´å…ƒç´ çš„æ–°æ—§keyå€¼ä¸ä¸€æ ·ï¼Œå³keyå€¼ä¸ç¨³å®šï¼Œæ‰€ä»¥keyå€¼å°±å¤±å»å…¶å­˜åœ¨çš„æ„ä¹‰äº†</p> <p>æ¯”è¾ƒåˆé€‚çš„keyå€¼æœ‰ï¼šidæˆ–è€…ä¸ä¸€æ ·çš„å†…å®¹</p></div> <h2 id="å®ä¾‹æ¨¡æ‹Ÿ"><a href="#å®ä¾‹æ¨¡æ‹Ÿ" class="header-anchor">#</a> å®ä¾‹æ¨¡æ‹Ÿ</h2> <p>å‡è®¾æ—§èŠ‚ç‚¹ä¸º a b d
æ–°çš„ä¸º      a c d b</p> <div class="language-js extra-class"><pre class="language-js"><code>oldS <span class="token operator">=</span> a<span class="token punctuation">,</span> oldE <span class="token operator">=</span> d<span class="token punctuation">;</span>

<span class="token constant">S</span> <span class="token operator">=</span> a<span class="token punctuation">,</span> <span class="token constant">E</span> <span class="token operator">=</span> d

</code></pre></div><p>oldSå’ŒSåŒ¹é…ï¼Œåˆ™å°†domä¸­çš„aèŠ‚ç‚¹æ”¾åˆ°ç¬¬ä¸€ä¸ªï¼Œå·²ç»æ˜¯ç¬¬ä¸€ä¸ªäº†å°±ä¸ç®¡äº†ï¼Œæ­¤æ—¶domçš„ä½ç½®ä¸ºï¼ša b d</p> <div class="language-js extra-class"><pre class="language-js"><code>oldS <span class="token operator">=</span> b<span class="token punctuation">,</span> oldE <span class="token operator">=</span> d<span class="token punctuation">;</span>
<span class="token constant">S</span> <span class="token operator">=</span> c<span class="token punctuation">,</span> <span class="token constant">E</span> <span class="token operator">=</span> b<span class="token punctuation">;</span>
</code></pre></div><p>oldSå’ŒEåŒ¹é…ï¼Œå°±å°†åŸæœ¬çš„bèŠ‚ç‚¹ç§»åŠ¨åˆ°æœ€åï¼Œå› ä¸ºEæ˜¯æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»–ä»¬ä½ç½®è¦ä¸€è‡´ï¼Œè¿™å°±æ˜¯ä¸Šé¢è¯´çš„ï¼šå½“å…¶ä¸­ä¸¤ä¸ªèƒ½åŒ¹é…ä¸Šé‚£ä¹ˆçœŸå®domä¸­çš„ç›¸åº”èŠ‚ç‚¹ä¼šç§»åˆ°Vnodeç›¸åº”çš„ä½ç½®ï¼Œæ­¤æ—¶domçš„ä½ç½®ä¸ºï¼ša d b</p> <div class="language-js extra-class"><pre class="language-js"><code>oldS <span class="token operator">=</span> d<span class="token punctuation">,</span> oldE <span class="token operator">=</span> dï¼›
<span class="token constant">S</span> <span class="token operator">=</span> c<span class="token punctuation">,</span> <span class="token constant">E</span> <span class="token operator">=</span> d<span class="token punctuation">;</span>
</code></pre></div><p>oldEå’ŒEåŒ¹é…ï¼Œä½ç½®ä¸å˜æ­¤æ—¶domçš„ä½ç½®ä¸ºï¼ša d b</p> <div class="language-js extra-class"><pre class="language-js"><code>oldS<span class="token operator">++</span><span class="token punctuation">;</span>
oldE<span class="token operator">--</span><span class="token punctuation">;</span>
oldS <span class="token operator">&gt;</span> oldE<span class="token punctuation">;</span>
</code></pre></div><p>éå†ç»“æŸï¼Œè¯´æ˜oldChå…ˆéå†å®Œã€‚å°±å°†å‰©ä½™çš„vChèŠ‚ç‚¹æ ¹æ®è‡ªå·±çš„çš„indexæ’å…¥åˆ°çœŸå®domä¸­å»ï¼Œæ­¤æ—¶domä½ç½®ä¸ºï¼ša c d b</p> <div class="custom-block warning"><p class="custom-block-title">åŒ¹é…ç»“æŸçš„æ¡ä»¶</p> <p>oldS &gt; oldEè¡¨ç¤ºoldChå…ˆéå†å®Œï¼Œé‚£ä¹ˆå°±å°†å¤šä½™çš„vChæ ¹æ®indexæ·»åŠ åˆ°domä¸­å»</p> <p>S &gt; Eè¡¨ç¤ºvChå…ˆéå†å®Œï¼Œé‚£ä¹ˆå°±åœ¨çœŸå®domä¸­å°†åŒºé—´ä¸º[oldS, oldE]çš„å¤šä½™èŠ‚ç‚¹åˆ æ‰</p></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/vueskill/router.html" class="prev">
        å…¨å±€è·¯ç”±
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.0546edb6.js" defer></script><script src="/assets/js/2.705226bb.js" defer></script><script src="/assets/js/24.887cb6da.js" defer></script>
  </body>
</html>
